{"version":3,"sources":["../../src/utils/pass_utils.js"],"names":[],"mappings":";;;;;;;;sBAAiB,SAAS;;;;sBAEZ,QAAQ;;;;6BACc,eAAe;;AAG5C,IAAM,QAAQ,GAAG,SAAX,QAAQ;SAAS,6BAAS,eAAe,EAAE,EAAE,KAAK,EAAE,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC;CAAA,CAAC;;AAC5E,IAAM,QAAQ,GAAG,SAAX,QAAQ,GAAS;AAC5B,UAAQ,EAAE,CAAC;AACX,+BAAS,eAAe,EAAE,EAAE,KAAK,EAAE,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;CACtD,CAAC;;;AAEK,IAAM,QAAQ,GAAG,SAAX,QAAQ,CAAI,QAAQ,EAAK;AACpC,MAAI;AACF,YAAQ,EAAE,CAAC;AACX,WAAO,4CAAsB,QAAQ,EAAI,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,OAAO,EAAE,CAAC,CAAC;GAC7E,CAAC,OAAO,KAAK,EAAE;AACd,QAAI,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,8BAA8B,CAAC,KAAK,CAAC,CAAC,EAAE;AAChE,aAAO,IAAI,CAAC;KACb;AACD,UAAM,KAAK,CAAC;GACb;CACF,CAAC;;;AAEK,IAAM,OAAO,GAAG,SAAV,OAAO,CAAG,QAAQ;SAC7B,CAAC,oBAAE,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;CAC/B,CAAC;;;AAEK,IAAM,YAAY,GAAG,SAAf,YAAY,CAAI,QAAQ,EAAkB;MAAhB,MAAM,yDAAG,EAAE;;;AAEhD,qDAA6B,QAAQ,SAAI,MAAM,CAAG,CAAC;AACnD,UAAQ,EAAE,CAAC;AACX,SAAO,QAAQ,CAAC,QAAQ,CAAC,CAAC;CAC3B,CAAC;;AACK,IAAM,YAAY,GAAG,SAAf,YAAY,CAAG,QAAQ;SAAI,oBAAK,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;CAAA,CAAC;;;AAEnE,IAAM,SAAS,GAAG,SAAZ,SAAS,CAAI,QAAQ,EAAE,KAAK,EAAK;AAC5C,SAAO,CAAC,GAAG,CAAC,iBAAiB,EAAE,QAAQ,CAAC,CAAC;AACzC,gDAAwB,QAAQ,UAAO,EAAE,KAAK,EAAL,KAAK,EAAE,KAAK,EAAE,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;AACzE,UAAQ,EAAE,CAAC;CACZ,CAAC;;;AAEK,IAAM,QAAQ,GAAG,SAAX,QAAQ,CAAI,QAAQ,EAAK;AACpC,UAAQ,EAAE,CAAC;AACX,gCAAU,MAAM,EAAE,CAAC,MAAM,EAAE,QAAQ,CAAC,EAAE;AACpC,SAAK,EAAE,SAAS;GACjB,CAAC,CAAC;AACH,UAAQ,EAAE,CAAC;CACZ,CAAC","file":"pass_utils.js","sourcesContent":["import yaml from 'js-yaml';\n\nimport _ from 'lodash';\nimport { execSync, spawnSync } from 'child_process';\n\n\nexport const pullPass = () => execSync('pass git pull', { stdio: ['pipe', 1, 2] });\nexport const pushPass = () => {\n  pullPass();\n  execSync('pass git push', { stdio: ['pipe', 1, 2] });\n};\n\nexport const readPass = (passPath) => {\n  try {\n    pullPass();\n    return execSync(`pass show ${passPath}`, { stdio: [0], encoding: 'utf-8' });\n  } catch (error) {\n    if (error.message.indexOf('is not in the password store') !== -1) {\n      return null;\n    }\n    throw error;\n  }\n};\n\nexport const hasPass = passPath => (\n  !_.isEmpty(readPass(passPath))\n);\n\nexport const generatePass = (passPath, length = 32) => {\n  // generate without symbols\n  execSync(`pass generate -n ${passPath} ${length}`);\n  pushPass();\n  return readPass(passPath);\n};\nexport const readPassYaml = passPath => yaml.safeLoad(readPass(passPath));\n\nexport const writePass = (passPath, input) => {\n  console.log('writing to pass', passPath);\n  execSync(`pass insert ${passPath} -m`, { input, stdio: ['pipe', 1, 2] });\n  pushPass();\n};\n\nexport const editPass = (passPath) => {\n  pullPass();\n  spawnSync('pass', ['edit', passPath], {\n    stdio: 'inherit',\n  });\n  pushPass();\n};\n"]}